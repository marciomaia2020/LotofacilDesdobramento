<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desdobramento Lotofácil</title>
    <link rel="stylesheet" href="/css/styles.css"> <!-- Corrija o caminho do CSS se necessário -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Desdobramento Lotofácil</h1>

        <h3>Números disponíveis (Desdobramento para 22 dezenas)</h3>

        <div class="table-container">
            <table id="numeros">
                <tr>
                    <!-- Os números serão inseridos aqui via JavaScript -->
                </tr>
            </table>
        </div>

        <div class="instructions">
            <p><strong>Instruções:</strong></p>
            <ul>
                <li>Exclua exatamente <strong>3 dezenas</strong>.</li>
                <li>Escolha <strong>uma dezena</strong> para fixar.</li>
                <li>Selecione a <strong>quantidade de jogos</strong> que deseja gerar.</li>
                <li>Escolha até 5 dezenas adicionais (<span style="color: red;">opcional</span>).</li>
            </ul>
        </div>

        <div class="number-selection">
            <label for="excluir">Dezenas a excluir:</label>
            <input type="text" id="excluir" placeholder="Ex: 01, 05, 10">
        </div>
        <div class="number-selection">
            <label for="fixar">Dezena a fixar:</label>
            <input type="text" id="fixar" placeholder="Ex: 07">
        </div>
        <div class="number-selection">
            <label for="jogos">Quantidade de jogos:</label>
            <input type="number" id="jogos" min="1" max="100" placeholder="Ex: 5">
        </div>
        <div class="number-selection">
            <label for="dezenas-adicionais">Dezenas adicionais: (<span style="color: red;">opcional</span>)</label>
            <input type="text" id="dezenas-adicionais" placeholder="Ex: 18, 21">
        </div>
        <div class="button-generateGames">
            <button onclick="gerarJogos()">Gerar Jogos</button>
        </div>
        <div class="button-container">
            <button onclick="salvarJogo()">Salvar Jogo</button>
            <button onclick="resetarJogo()">Resetar Jogo</button>
            <button onclick="exportarParaExcel()">Exportar para Excel</button>
        </div>
        
        <div class="userInformation">
            <p>Os jogos serão gerados com 15 dezenas.</p>
            <p>Escolha até 5 dezenas adicionais (<span style="color: red;">opcional</span>).</p>
        </div>

        <div id="jogosGerados">
            <!-- Os jogos gerados serão inseridos aqui via JavaScript -->
        </div>

        <div class="userInformationUnderstanding">
            <th><b><i>Resumo</i></b></th>
            <ol>
                <li>A <b>dezena à fixar</b> não será incluída nos números aleatórios gerados.</li>
                <li>As <b>dezenas excluídas</b> serão removidas da lista de <i>números disponíveis</i>.</li>
                <li>Ao <b>gerar jogos</b> o formato sempre será 01, 02, ....</li>
                <li>Ao clicar em <b>salvar jogo</b> será gerado um arquivo *.txt para download.</li>
                <li>O <i>formato do arquivo para download</i> virá pronto para ser copiado/colado no
                <a href="https://play.google.com/store/apps/details?id=gerador.licoski.com&hl=pt_BR&pli=1" target="_blank"> conferidor da lotofácil</a>.</li>
            </ol>
        </div>

            <div class="info-container">
                <h2>Resumo do Processo de Geração de Jogos</h2>
                <p>Sim, a técnica utilizada para gerar os jogos pode ser considerada uma forma de desdobramento, mas com um foco específico e personalizado. Aqui está um resumo de como isso funciona e como a quantidade de jogos afeta o processo:</p>

                <h3>O Que Está Sendo Feito</h3>
                <ul>
                    <li><strong>Inclusão da Dezena Fixa:</strong> A dezena fixa é incluída em todos os jogos. Esta é uma estratégia comum em sistemas de loteria para garantir que uma dezena específica esteja sempre presente.</li>
                    <li><strong>Distribuição de Números Restantes:</strong> Os números restantes são distribuídos entre os jogos gerados. Nenhum número é repetido dentro de um mesmo jogo, e a quantidade de números adicionais é determinada pela quantidade total de dezenas (15) menos a dezena fixa.</li>
                    <li><strong>Variedade e Exclusões:</strong> A quantidade de jogos e a exclusão de certas dezenas influenciam a variabilidade dos jogos. Se você escolhe uma quantidade maior de jogos, o algoritmo tenta garantir uma distribuição mais variada dos números restantes, respeitando as exclusões e a presença obrigatória da dezena fixa.</li>
                </ul>

                <h3>Impacto da Quantidade de Jogos</h3>
                <ul>
                    <li><strong>Menos Jogos:</strong> Se você gerar menos jogos, pode haver uma chance maior de que alguns números não apareçam em todos os jogos, especialmente se a quantidade de números disponíveis for relativamente pequena.</li>
                    <li><strong>Mais Jogos:</strong> Quando você gera um número maior de jogos, o algoritmo tenta distribuir os números disponíveis de forma que todos sejam utilizados de maneira equilibrada, considerando a quantidade total de jogos e os números excluídos.</li>
                </ul>

                <h3>Exemplo de Desdobramento</h3>
                <p>Se você quiser gerar jogos de forma a maximizar a cobertura e garantir que cada jogo tenha uma combinação única de 15 dezenas com uma dezena fixa incluída, pode usar a lógica descrita. Isso é especialmente útil em loterias onde você quer ter a certeza de que a dezena fixa estará presente em cada combinação gerada.</p>
            </div>
        </div>
    </div>

    <script src="/js/script.js"></script> <!-- Corrija o caminho do JavaScript se necessário -->

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const numerosTable = document.getElementById('numeros').getElementsByTagName('tr')[0];
        
        // Preenche a tabela com números de 01 a 25
        for (let i = 1; i <= 25; i++) {
            const td = document.createElement('td');
            td.textContent = i.toString().padStart(2, '0');
            numerosTable.appendChild(td);
        }
    });

    function gerarJogos() {
        const excluir = document.getElementById('excluir').value.split(',').map(num => Number(num.trim())).filter(num => !isNaN(num));
        const fixar = Number(document.getElementById('fixar').value.trim());
        const dezenasAdicionais = document.getElementById('dezenas-adicionais').value.split(',').map(num => Number(num.trim())).filter(num => !isNaN(num) && num >= 1 && num <= 25);
        const quantidadeJogos = Number(document.getElementById('jogos').value.trim());
        const jogosGeradosDiv = document.getElementById('jogosGerados');
        jogosGeradosDiv.innerHTML = ''; // Limpa jogos anteriores

        // Validação básica
        if (excluir.length !== 3 || isNaN(fixar) || isNaN(quantidadeJogos) || !Number.isInteger(quantidadeJogos)) {
            alert('Por favor, insira as dezenas corretamente e selecione uma quantidade de jogos válida.');
            return;
        }

        // Verifica se a dezena fixada está entre as dezenas excluídas
        if (excluir.includes(fixar)) {
            alert('A dezena a ser fixada não pode estar entre as dezenas excluídas. Por favor, escolha outra.');
            return;
        }

        // Verifica se as dezenas adicionais estão entre as dezenas excluídas ou a dezena fixa
        for (let dezenaAdicional of dezenasAdicionais) {
            if (excluir.includes(dezenaAdicional) || dezenaAdicional === fixar) {
                alert('As dezenas adicionais não podem estar entre as dezenas excluídas ou ser a dezena fixa. Por favor, escolha outras.');
                return;
            }
        }

        // Números disponíveis (de 01 a 25, exceto os excluídos e a dezena fixa)
        const numerosDisponiveis = [];
        for (let i = 1; i <= 25; i++) {
            if (!excluir.includes(i) && i !== fixar && !dezenasAdicionais.includes(i)) {
                numerosDisponiveis.push(i);
            }
        }

        if (numerosDisponiveis.length < 15 - dezenasAdicionais.length - 1) {
            alert('Não há dezenas suficientes para gerar os jogos com as restrições fornecidas.');
            return;
        }

        // Geração dos jogos
        const jogos = [];
        for (let i = 0; i < quantidadeJogos; i++) {
            const numerosSorteados = [...numerosDisponiveis];
            numerosSorteados.sort(() => Math.random() - 0.5); // Embaralha os números disponíveis

            const jogo = [fixar, ...dezenasAdicionais, ...numerosSorteados.slice(0, 15 - 1 - dezenasAdicionais.length)];
            jogo.sort((a, b) => a - b); // Ordena o jogo
            jogos.push(jogo);
        }

        // Exibição dos jogos gerados
        jogos.forEach((jogo, index) => {
            const jogoDiv = document.createElement('div');
            jogoDiv.textContent = `Jogo ${index + 1}: `;

            jogo.forEach(dezena => {
                const span = document.createElement('span');
                span.textContent = dezena.toString().padStart(2, '0');
                if (dezena === fixar) {
                    span.style.color = 'green'; // Destaque para a dezena fixa
                }
                jogoDiv.appendChild(span);
                jogoDiv.appendChild(document.createTextNode(' '));
            });

            jogosGeradosDiv.appendChild(jogoDiv);
        });
    }

    function salvarJogo() {
        const jogosGeradosDiv = document.getElementById('jogosGerados');
        const jogosText = jogosGeradosDiv.innerText.replace(/Jogo \d+: /g, '').trim().replace(/\n/g, '\r\n');

        const blob = new Blob([jogosText], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'jogos_lotofacil.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    function resetarJogo() {
        document.getElementById('excluir').value = '';
        document.getElementById('fixar').value = '';
        document.getElementById('jogos').value = '';
        document.getElementById('dezenas-adicionais').value = '';
        document.getElementById('jogosGerados').innerHTML = '';
    }

    function exportarParaExcel() {
        const jogosGeradosDiv = document.getElementById('jogosGerados');
        const jogos = jogosGeradosDiv.innerText.trim().split('\n').map(jogo => jogo.replace(/Jogo \d+: /, '').trim().split(' '));
        
        const ws = XLSX.utils.aoa_to_sheet(jogos);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Jogos");
        
        XLSX.writeFile(wb, "jogos_lotofacil.xlsx");
    }
</script>

</body>
</html>
